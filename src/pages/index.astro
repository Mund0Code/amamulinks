---
// src/pages/index.astro
import { fetchLinksFromNotion, type LinkItem } from "../lib/notion";

const links: LinkItem[] = await fetchLinksFromNotion();

const highlighted = links.filter((l) => l.highlight);
const others = links.filter((l) => !l.highlight);
---

<html lang="es">
  <head>
    <meta charset="utf-8" />
    <title>Amamu Links</title>
    <meta
      name="description"
      content="Productos recomendados con enlaces de afiliado Amazon y Temu."
    />
  </head>
  <body
    class="min-h-screen text-white"
    style="
      background: radial-gradient(circle at top,
        #020617 0%, #020617 40%, #0b1120 70%, #020617 100%);
      font-family: system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
    "
  >
    <main class="flex items-center justify-center min-h-screen p-5">
      <div
        class="w-full max-w-5xl p-1 rounded-[30px]"
        style="background: linear-gradient(135deg,
          rgba(56,189,248,0.65),
          rgba(168,85,247,0.5),
          rgba(248,113,113,0.5));"
      >
        <div
          class="w-full h-full rounded-[26px] p-6 md:p-8"
          style="
            background: rgba(15,23,42,0.88);
            box-shadow: 0 26px 80px rgba(15,23,42,0.95);
            border: 1px solid rgba(148,163,184,0.35);
            backdrop-filter: blur(18px);
          "
        >
          <!-- HEADER -->
          <section class="flex flex-col items-center gap-4 w-full mb-6">
            <div
              class="p-1 rounded-full"
              style="
                background: linear-gradient(120deg, #38bdf8, #a855f7, #f97316);
                box-shadow: 0 15px 35px rgba(15,23,42,0.85);
              "
            >
              <div
                class="w-16 h-16 rounded-full bg-slate-900 flex items-center justify-center text-xl font-bold"
              >
                AL
              </div>
            </div>

            <h1 class="text-3xl md:text-4xl font-bold">Amamu Links</h1>
            <p class="text-sm md:text-base opacity-85 text-center max-w-xl">
              Productos recomendados con enlaces de afiliado Amazon y Temu.
            </p>

            <div class="flex items-center w-full text-xs md:text-sm opacity-80 gap-2">
              <span>âœ¨ SelecciÃ³n curada</span>
              <span class="flex-1 border-t border-slate-600 mx-2"></span>
              <span>ðŸ”— Enlaces oficiales</span>
            </div>
          </section>

          <!-- DESTACADOS -->
          {highlighted.length > 0 && (
            <section class="w-full mb-5">
              <h2 class="text-lg font-medium opacity-90 mb-2">Destacados</h2>
              <div
                class="grid gap-3"
                style="grid-template-columns: repeat(auto-fit, minmax(260px, 1fr));"
              >
                {highlighted.map((item) => (
                  <a
                    href={item.url}
                    target="_blank"
                    rel="noopener noreferrer"
                    class="no-underline"
                  >
                    <div
                      class="w-full h-full p-4 rounded-[20px] transition-transform duration-150"
                      style="
                        background: linear-gradient(135deg,
                          rgba(15,23,42,0.96),
                          rgba(30,64,175,0.85));
                        border: 1px solid rgba(148,163,184,0.35);
                        box-shadow: 0 18px 40px rgba(15,23,42,0.6);
                      "
                      onmouseover="this.style.transform='translateY(-3px) scale(1.01)'; this.style.boxShadow='0 24px 60px rgba(15,23,42,0.9)'; this.style.borderColor='rgba(96,165,250,0.8)';"
                      onmouseout="this.style.transform=''; this.style.boxShadow='0 18px 40px rgba(15,23,42,0.6)'; this.style.borderColor='rgba(148,163,184,0.35)';"
                    >
                      <div class="flex items-center gap-3">
                        <!-- Imagen -->
                        <div>
                          {item.image ? (
                            <img
                              src={item.image}
                              alt={item.title}
                              class="w-20 h-20 rounded-[18px] object-cover border border-slate-500/60 bg-slate-950"
                            />
                          ) : (
                            <div
                              class="w-20 h-20 rounded-[18px] border border-slate-500/60 flex items-center justify-center text-[11px] opacity-70"
                              style="background: radial-gradient(circle at top, #1f2937, #020617);"
                            >
                              Sin imagen
                            </div>
                          )}
                        </div>

                        <!-- Texto -->
                        <div class="flex flex-col gap-2 flex-1">
                          <div class="flex items-center w-full gap-2">
                            <span
                              class="px-2 py-0.5 rounded-full text-[10px] uppercase tracking-[0.06em] opacity-90 bg-slate-100/10"
                            >
                              {item.category}
                            </span>
                            {item.badge && (
                              <span
                                class="px-2 py-0.5 rounded-full text-[10px] uppercase tracking-[0.05em] bg-yellow-400 text-black"
                              >
                                {item.badge}
                              </span>
                            )}
                            <span class="flex-1" />
                          </div>

                          <h3 class="text-base font-bold">{item.title}</h3>
                          <p class="text-xs opacity-85 line-clamp-3">
                            {item.description}
                          </p>

                          <div class="flex items-center w-full gap-2 text-xs">
                            <span
                              class="px-2 py-0.5 rounded-full text-[11px] bg-slate-100/10"
                            >
                              {item.marketplace === "amazon"
                                ? "Amazon"
                                : item.marketplace === "temu"
                                ? "Temu"
                                : "Producto"}
                            </span>
                            <span class="flex-1" />
                          </div>
                        </div>
                      </div>
                    </div>
                  </a>
                ))}
              </div>
            </section>
          )}

          <!-- MÃS PRODUCTOS -->
          {others.length > 0 && (
            <section class="w-full mt-4">
              <h2 class="text-lg font-medium opacity-90 mb-2">MÃ¡s productos</h2>
              <div
                class="grid gap-3"
                style="grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));"
              >
                {others.map((item) => (
                  <a
                    href={item.url}
                    target="_blank"
                    rel="noopener noreferrer"
                    class="no-underline"
                  >
                    <div
                      class="w-full h-full p-4 rounded-[20px] transition-transform duration-150"
                      style="
                        background: linear-gradient(135deg,
                          rgba(15,23,42,0.96),
                          rgba(30,64,175,0.85));
                        border: 1px solid rgba(148,163,184,0.35);
                        box-shadow: 0 18px 40px rgba(15,23,42,0.6);
                      "
                      onmouseover="this.style.transform='translateY(-3px) scale(1.01)'; this.style.boxShadow='0 24px 60px rgba(15,23,42,0.9)'; this.style.borderColor='rgba(96,165,250,0.8)';"
                      onmouseout="this.style.transform=''; this.style.boxShadow='0 18px 40px rgba(15,23,42,0.6)'; this.style.borderColor='rgba(148,163,184,0.35)';"
                    >
                      <div class="flex items-center gap-3">
                        <!-- Imagen -->
                        <div>
                          {item.image ? (
                            <img
                              src={item.image}
                              alt={item.title}
                              class="w-20 h-20 rounded-[18px] object-cover border border-slate-500/60 bg-slate-950"
                            />
                          ) : (
                            <div
                              class="w-20 h-20 rounded-[18px] border border-slate-500/60 flex items-center justify-center text-[11px] opacity-70"
                              style="background: radial-gradient(circle at top, #1f2937, #020617);"
                            >
                              Sin imagen
                            </div>
                          )}
                        </div>

                        <!-- Texto -->
                        <div class="flex flex-col gap-2 flex-1">
                          <div class="flex items-center w-full gap-2">
                            <span
                              class="px-2 py-0.5 rounded-full text-[10px] uppercase tracking-[0.06em] opacity-90 bg-slate-100/10"
                            >
                              {item.category}
                            </span>
                            {item.badge && (
                              <span
                                class="px-2 py-0.5 rounded-full text-[10px] uppercase tracking-[0.05em] bg-yellow-400 text-black"
                              >
                                {item.badge}
                              </span>
                            )}
                            <span class="flex-1" />
                          </div>

                          <h3 class="text-base font-bold">{item.title}</h3>
                          <p class="text-xs opacity-85 line-clamp-3">
                            {item.description}
                          </p>

                          <div class="flex items-center w-full gap-2 text-xs">
                            <span
                              class="px-2 py-0.5 rounded-full text-[11px] bg-slate-100/10"
                            >
                              {item.marketplace === "amazon"
                                ? "Amazon"
                                : item.marketplace === "temu"
                                ? "Temu"
                                : "Producto"}
                            </span>
                            <span class="flex-1" />
                          </div>
                        </div>
                      </div>
                    </div>
                  </a>
                ))}
              </div>
            </section>
          )}

          <!-- FOOTER -->
          <footer class="mt-10 text-center text-[11px] opacity-70 space-y-1">
            <p>Algunos enlaces son de afiliado (Amazon / Temu).</p>
            <p>
              Si compras a travÃ©s de ellos, apoyas mi trabajo sin coste extra para ti.
            </p>
            <p>Â© 2025 Amamu. Hecho con Astro.</p>
          </footer>
        </div>
      </div>
    </main>
  </body>
</html>
